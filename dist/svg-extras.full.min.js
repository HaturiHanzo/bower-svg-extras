"use strict";function Events(){}function EE(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function EventEmitter(){this._events=new Events,this._eventsCount=0}var has=Object.prototype.hasOwnProperty,prefix="~";Object.create&&(Events.prototype=Object.create(null),(new Events).__proto__||(prefix=!1)),EventEmitter.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)has.call(e,t)&&n.push(prefix?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},EventEmitter.prototype.listeners=function(e,t){var n=prefix?prefix+e:e,r=this._events[n];if(t)return!!r;if(!r)return[];if(r.fn)return[r.fn];for(var s=0,i=r.length,o=new Array(i);s<i;s++)o[s]=r[s].fn;return o},EventEmitter.prototype.emit=function(e,t,n,r,s,i){var o=prefix?prefix+e:e;if(!this._events[o])return!1;var v,f,h=this._events[o],c=arguments.length;if(h.fn){switch(h.once&&this.removeListener(e,h.fn,void 0,!0),c){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,t),!0;case 3:return h.fn.call(h.context,t,n),!0;case 4:return h.fn.call(h.context,t,n,r),!0;case 5:return h.fn.call(h.context,t,n,r,s),!0;case 6:return h.fn.call(h.context,t,n,r,s,i),!0}for(f=1,v=new Array(c-1);f<c;f++)v[f-1]=arguments[f];h.fn.apply(h.context,v)}else{var p,a=h.length;for(f=0;f<a;f++)switch(h[f].once&&this.removeListener(e,h[f].fn,void 0,!0),c){case 1:h[f].fn.call(h[f].context);break;case 2:h[f].fn.call(h[f].context,t);break;case 3:h[f].fn.call(h[f].context,t,n);break;case 4:h[f].fn.call(h[f].context,t,n,r);break;default:if(!v)for(p=1,v=new Array(c-1);p<c;p++)v[p-1]=arguments[p];h[f].fn.apply(h[f].context,v)}}return!0},EventEmitter.prototype.on=function(e,t,n){var r=new EE(t,n||this),s=prefix?prefix+e:e;return this._events[s]?this._events[s].fn?this._events[s]=[this._events[s],r]:this._events[s].push(r):(this._events[s]=r,this._eventsCount++),this},EventEmitter.prototype.once=function(e,t,n){var r=new EE(t,n||this,(!0)),s=prefix?prefix+e:e;return this._events[s]?this._events[s].fn?this._events[s]=[this._events[s],r]:this._events[s].push(r):(this._events[s]=r,this._eventsCount++),this},EventEmitter.prototype.removeListener=function(e,t,n,r){var s=prefix?prefix+e:e;if(!this._events[s])return this;if(!t)return 0===--this._eventsCount?this._events=new Events:delete this._events[s],this;var i=this._events[s];if(i.fn)i.fn!==t||r&&!i.once||n&&i.context!==n||(0===--this._eventsCount?this._events=new Events:delete this._events[s]);else{for(var o=0,v=[],f=i.length;o<f;o++)(i[o].fn!==t||r&&!i[o].once||n&&i[o].context!==n)&&v.push(i[o]);v.length?this._events[s]=1===v.length?v[0]:v:0===--this._eventsCount?this._events=new Events:delete this._events[s]}return this},EventEmitter.prototype.removeAllListeners=function(e){var t;return e?(t=prefix?prefix+e:e,this._events[t]&&(0===--this._eventsCount?this._events=new Events:delete this._events[t])):(this._events=new Events,this._eventsCount=0),this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.addListener=EventEmitter.prototype.on,EventEmitter.prototype.setMaxListeners=function(){return this},EventEmitter.prefixed=prefix,EventEmitter.EventEmitter=EventEmitter,"undefined"!=typeof module&&(module.exports=EventEmitter);
!function(t){function r(t){var r=p(t);if(v)for(var n,o=0;n=d[o++];)t.hasOwnProperty(n)&&r.push(n);return r}function n(t,n,o){for(var e,u,c=r(o),f=0,p=c.length;f<p;)"__self"!==(e=c[f++])&&(u=o[e],l(u)&&(!i||u.toString().indexOf(".__base")>-1)?n[e]=function(r,o){var e=t[r]?t[r]:"__constructor"===r?n.__self.__parent:y,i=function(){var t=this.__base;this.__base=i.__base;var r=o.apply(this,arguments);return this.__base=t,r};return i.__base=e,i}(e,u):n[e]=u)}function o(t,r){for(var n,o=1;n=t[o++];)r?l(n)?e.self(r,n.prototype,n):e.self(r,n):r=l(n)?e(t[0],n.prototype,n):e(t[0],n);return r||t[0]}function e(){var t=arguments,r=_(t[0]),e=r||l(t[0]),i=e?r?o(t[0]):t[0]:u,c=t[e?1:0]||{},p=t[e?2:1],s=c.__constructor||e&&i.prototype.__constructor?function(){return this.__constructor.apply(this,arguments)}:e?function(){return i.apply(this,arguments)}:function(){};if(!e)return s.prototype=c,s.prototype.__self=s.prototype.constructor=s,a(s,p);a(s,i),s.__parent=i;var y=i.prototype,v=s.prototype=f(y);return v.__self=v.constructor=s,c&&n(y,v,c),p&&n(i,s,p),s}var i=function(){"_"}.toString().indexOf("_")>-1,u=function(){},c=Object.prototype.hasOwnProperty,f=Object.create||function(t){var r=function(){};return r.prototype=t,new r},p=Object.keys||function(t){var r=[];for(var n in t)c.call(t,n)&&r.push(n);return r},a=function(t,r){for(var n in r)c.call(r,n)&&(t[n]=r[n]);return t},s=Object.prototype.toString,_=Array.isArray||function(t){return"[object Array]"===s.call(t)},l=function(t){return"[object Function]"===s.call(t)},y=function(){},v=!0,h={toString:""};for(var b in h)h.hasOwnProperty(b)&&(v=!1);var d=v?["toString","valueOf"]:null;e.self=function(){var t=arguments,r=_(t[0]),e=r?o(t[0],t[0][0]):t[0],i=t[1],u=t[2],c=e.prototype;return i&&n(c,c,i),u&&n(e,e,u),e};var O=!0;"object"==typeof exports&&(module.exports=e,O=!1),"object"==typeof modules&&"function"==typeof modules.define&&(modules.define("inherit",function(t){t(e)}),O=!1),"function"==typeof define&&(define(function(t,r,n){n.exports=e}),O=!1),O&&(t.inherit=e)}(this);
!function(t){"use strict";if(!EventEmitter)throw new Error("Svg-extras requires https://github.com/primus/eventemitter3");if(!inherit)throw new Error("Svg-extras requires https://github.com/dfilatov/inherit");var e="ontouchstart"in document.documentElement;t.svgext={_isTouchDevice:e,_throttleEventListener:function(t,e,i){var n=!1,s=!1;i=i||window;var o=function(t){return!n&&(n=!0,void requestAnimationFrame(function(){s||e(t),n=!1}))};return i.addEventListener(t,o,!1),function(){s=!0,i.removeEventListener(t,o)}},"default":{control:{width:12,height:12},borderedRect:{borderOffset:14}}}}(window),function(t){"use strict";t.SVGElement=inherit({NS:"http://www.w3.org/2000/svg",__constructor:function(t,e){t=t||{},this.rootNode=this.node="string"==typeof e?this.createElem(e):e,this._ee=new EventEmitter,t.cssClass&&this.addClass(t.cssClass),t.backgroundColor?this.attr("fill",t.backgroundColor):this.addClass("svg_bg-color_default"),this.on("dragstart",function(t){t.preventDefault()})},hasClass:function(t){var e=this.attr("class");return!!e&&new RegExp("(\\s|^)"+t+"(\\s|$)").test(e)},addClass:function(t){return t.split(/\s+/).forEach(function(t){if(!this.hasClass(t)){var e=this.attr("class")||"";this.attr("class",e+" "+t)}},this),this},removeClass:function(t){var e=this.node.getAttribute("class");if(e){var i=new RegExp("(?:(\\s|^))"+t+"(?=\\s|$)","g");this.attr("class",e.replace(i,""))}return this},hide:function(){return this.addClass("svg-element_hidden")},show:function(){return this.removeClass("svg-element_hidden")},attr:function(t,e){return void 0===e?this.node.getAttribute(t):(this.emit("change."+t,e),this.node.setAttribute(t,e),this)},bringToFront:function(){var t=this.rootNode.parentNode;return t.removeChild(this.rootNode),t.appendChild(this.rootNode),this},activate:function(){return this.isActive=!0,this.addClass("active"),this.emit("activated"),this},deactivate:function(){return this.isActive=!1,this.emit("deactivated"),this.removeClass("active")},on:function(t,e){return"on"+t in this.node?this.node.addEventListener(t,e):this._ee.on(t,e),this},emit:function(){this._ee.emit.apply(this._ee,arguments)},onDoubleTap:function(t){var e=!1,i=function(i){e?(clearTimeout(e),e=null,i.stopPropagation(),t(i)):e=setTimeout(function(){e=null},300)};return this.on("touchstart",i),i},offDoubleTap:function(t){return this.off("touchstart",t)},off:function(t,e){return"on"+t in this.node?this.node.removeEventListener(t,e):this._ee.removeListener(t,e),this},getContainerRect:function(){return this.node.ownerSVGElement.getBoundingClientRect()},getRect:function(){return this.node.getBoundingClientRect()},destroy:function(){Object.keys(this).forEach(function(t){delete this[t]},this)},createElem:function(t){return document.createElementNS(this.NS,t)},onAppend:function(t){this.container=t}})}(svgext),function(t){"use strict";t.SVGBlock={__constructor:function(){this.__base.apply(this,arguments),this.children=[]},append:function(t){return this.children.push(t),t.container=this,this.appendElem(t.rootNode),t.onAppend(this),this},appendElem:function(t){this.rootNode.appendChild(t)},remove:function(t){if(t)return t.isActive&&this.deactivateActiveElement&&this.deactivateActiveElement(),this.children.splice(this.children.indexOf(t),1),this.removeElem(t.rootNode),t.destroy(),this},removeElem:function(t){this.rootNode.removeChild(t)},hide:function(){this.__base(),this.children.forEach(function(t){t.hide()})},show:function(){this.__base(),this.children.forEach(function(t){t.show()})}}}(svgext),function(t){"use strict";t.SVGDraggable={__constructor:function(e){this.__base.apply(this,arguments),(e.isDraggable||void 0===e.isDraggable)&&(this._dndOnMouseMove=this._dndOnMouseMove.bind(this),this._dndOnMouseUp=this._dndOnMouseUp.bind(this),this.addClass("svg_draggable"),this.on(t._isTouchDevice?"touchstart":"mousedown",this._dndOnMouseDown.bind(this)))},destroy:function(){this.removeDndHandlers&&this.removeDndHandlers(),this.__base()},removeDndHandlers:function(){t._isTouchDevice?(window.removeEventListener("touchmove",this._dndOnMouseMove),window.removeEventListener("touchcancel",this._dndOnMouseUp),window.removeEventListener("touchend",this._dndOnMouseUp)):(window.removeEventListener("mousemove",this._dndOnMouseMove),window.removeEventListener("mouseup",this._dndOnMouseUp))},_dndOnMouseDown:function(e){e.which&&3===e.which||e.button&&2===e.button||(document.body.classList.add("unselectable"),this._saveClientCoords(e.changedTouches?e.changedTouches[0]:e),t._isTouchDevice?(window.addEventListener("touchmove",this._dndOnMouseMove),window.addEventListener("touchend",this._dndOnMouseUp),window.addEventListener("touchcancel",this._dndOnMouseUp)):(window.addEventListener("mousemove",this._dndOnMouseMove),window.addEventListener("mouseup",this._dndOnMouseUp)))},_dndOnMouseMove:function(t){if(void 0!==t.movementX)return this.drag(this.normalizeCoords({x:t.movementX,y:t.movementY}));var e=t;return e.changedTouches&&(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),e=t.changedTouches[0]),this._lastClientCoords?(this.drag(this.normalizeCoords({x:e.clientX-this._lastClientCoords.clientX,y:e.clientY-this._lastClientCoords.clientY})),void this._saveClientCoords(e)):this._saveClientCoords(e)},_saveClientCoords:function(t){this._lastClientCoords={clientX:t.clientX,clientY:t.clientY}},_dndOnMouseUp:function(){this._lastClientCoords=null,this.removeDndHandlers(),document.body.classList.remove("unselectable")},drag:function(){throw new Error("SVGDraggable.drag not implemented")},normalizeCoords:function(){throw new Error("SVGDraggable.normalizeCoords not implemented")}}}(svgext),function(t){"use strict";t.SVGContainer=inherit([t.SVGElement,t.SVGBlock],{__constructor:function(e){e=e||{},e.isDraggable=!1,e.cssClass=e.cssClass||"svg-container_fluid",this.__base(e,e.node||"svg"),this._offWindowResize=t._throttleEventListener("resize",this._onWindowResize.bind(this))},getInstances:function(t){return t?this._filterChildren(t):this.children},getActiveElement:function(){return this.activeElement},toggleAllInstances:function(t,e){return this.getInstances(e).forEach(function(e){t?e.show():e.deactivate().hide()}),this},setActiveElement:function(e){e&&e instanceof t.SVGElement&&!e.isActive&&(this.deactivateActiveElement(),e.activate(),this.activeElement=e)},deactivateActiveElement:function(){return this.activeElement&&(this.activeElement.deactivate(),this.activeElement=null),this},removeActiveInstance:function(t){this.activeElement&&(!t||t&&this.activeElement instanceof t)&&(this.remove(this.activeElement),this.activeElement=null)},removeAllInstances:function(t){var e=this.children;if(t)return this.removeActiveInstance(t),this.getInstances(t).forEach(this.remove,this);for(this.activeElement=null;e.length;)this.remove(e[0])},destroy:function(){this._offWindowResize(),this.__base()},_filterChildren:function(t){return this.children.filter(function(e){return e instanceof t})},_onWindowResize:function(){var t=this.getRect();return void 0===this._prevContainerWidth?(this._prevContainerWidth=t.width,void(this._prevContainerHeight=t.height)):void(t.width===this._prevContainerWidth&&t.height===this._prevContainerHeight||(this._resizeChildren(t.width/this._prevContainerWidth,t.height/this._prevContainerHeight),this._prevContainerWidth=t.width,this._prevContainerHeight=t.height))},_resizeChildren:function(t,e){this.children.forEach(function(i){i&&i.resize&&i.resize(t,e)})}})}(svgext),function(t){"use strict";t.SVGRect=inherit([t.SVGElement,t.SVGDraggable],{__constructor:function(t){t||(t={}),this.__base(t,"rect"),void 0!==t.width&&this.width(t.width),void 0!==t.height&&this.height(t.height),void 0!==t.x&&this.setX(t.x),void 0!==t.y&&this.setY(t.y)},setX:function(t){return this._rectX=t||0,this.attr("x",this._rectX)},getX:function(){return this._rectX},setY:function(t){return this._rectY=t||0,this.attr("y",this._rectY)},getY:function(){return this._rectY},width:function(t){return void 0===t?this._width:(this._width=t,this.attr("width",this._width))},height:function(t){return void 0===t?this._height:(this._height=t,this.attr("height",this._height))},normalizeCoords:function(t){var e=this.getX(),i=this.getY(),n=this.width(),s=this.height(),o=this.getContainerRect();return e+t.x<0?t.x=-1*e:e+n+t.x>o.width&&(t.x=o.width-e-n),i+t.y<0?t.y=-1*i:i+s+t.y>o.height&&(t.y=o.height-i-s),t},getValue:function(t){var e,i={width:this.width(),height:this.height()};return t&&(e=this.getContainerRect(),i.width/=e.width,i.height/=e.height),i},drag:function(t){this.setX(this.getX()+t.x).setY(this.getY()+t.y)}})}(svgext),function(t){"use strict";t.CartesianGeometryMath={distanceBtwTwoPoints:function(t,e){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))},lineSegmentMidPoint:function(t){return[t[0][0]+(t[1][0]-t[0][0])/2,t[0][1]+(t[1][1]-t[0][1])/2]},checkLinesIntersection:function(t,e){return this._arePointsCounterClockWise(t[0],e[0],e[1])!==this._arePointsCounterClockWise(t[1],e[0],e[1])&&this._arePointsCounterClockWise(t[0],t[1],e[0])!==this._arePointsCounterClockWise(t[0],t[1],e[1])},findPolygonInsertIndex:function(t,e){var i,n=Number.POSITIVE_INFINITY,s=this.generateLineSegments(t);return s.forEach(function(t,o){var r=this.lineSegmentMidPoint(t),h=this.distanceBtwTwoPoints(r,e);if(n>h){var c,a=s.slice();a.splice(o,1),c=a.some(function(t){return this.checkLinesIntersection(t,[r,e])},this),c||(n=h,i=o+1)}},this),i},generateLineSegments:function(t){for(var e=[],i=0;i<=t.length-4;i+=2)e.push([[t[i],t[i+1]],[t[i+2],t[i+3]]]);return e.push([[t[t.length-2],t[t.length-1]],[t[0],t[1]]]),e},_arePointsCounterClockWise:function(t,e,i){return(i[1]-t[1])*(e[0]-t[0])>(e[1]-t[1])*(i[0]-t[0])}}}(svgext),function(t){"use strict";t.SVGPolygonVertex=inherit(t.SVGRect,{__constructor:function(e){e=e?e:{isDraggable:!0},this.__base(e),t._isTouchDevice&&this.addClass("svg-control_type_touch")},normalizeCoords:function(t){var e=this.getX(),i=this.getY(),n=this.getContainerRect();return e+t.x<0?t.x=-1*e:e+t.x>n.width&&(t.x=n.width-e),i+t.y<0?t.y=-1*i:i+t.y>n.height&&(t.y=n.height-i),t},drag:function(t){this.__base(t),this.container.render()},setX:function(t){return this._rectX=t-this.width()/2,this.attr("x",this._rectX)},getX:function(){return this._rectX+this.width()/2},setY:function(t){return this._rectY=t-this.height()/2,this.attr("y",this._rectY)},getY:function(){return this._rectY+this.height()/2}})}(svgext),function(t){"use strict";var e=[t.SVGElement,t.SVGBlock,t.SVGDraggable];t.SVGPolygon=inherit(e,{__constructor:function(e){e=e||{},e.cssClass=e.cssClass||"svg-polygon",this.__base(e,"polygon"),this.rootNode=this.createElem("g"),this.appendElem(this.node),e.points&&this.setPoints(e.points),this.on(t._isTouchDevice?"touchstart":"mousedown",this.select.bind(this))},onAppend:function(e){return this.__base(e),this._onContainerDblClick=this._onContainerDblClick.bind(this),t._isTouchDevice?this._onContainerDblClick=this.container.onDoubleTap(this._onContainerDblClick):void this.container.on("dblclick",this._onContainerDblClick)},destroy:function(){t._isTouchDevice?this.container.offDoubleTap(this._onContainerDblClick):this.container.off("dblclick",this._onContainerDblClick),this.__base()},setPoints:function(t){if(t&&Array.isArray(t)&&t.length%2===0){this.vertexes&&this.vertexes.forEach(this.remove,this),this.vertexes=[];for(var e=0;e<t.length-1;e+=2)this.vertexes.push(this._createVertex([t[e],t[e+1]]));this.render()}return this},render:function(){return this.attr("points",this.vertexes.reduce(function(t,e){return t.push(e.getX()+","+e.getY()),t},[]).join(" ")),this},addPoint:function(e){var i=this.getValue(!1);if(i&&i.length){var n=this._createVertex(e).addClass("active");this.vertexes.splice(t.CartesianGeometryMath.findPolygonInsertIndex(i,e),0,n),this.render()}return this},normalizeCoords:function(t){return this.vertexes.forEach(function(e){t=e.normalizeCoords(t)}),t},drag:function(t){this.vertexes.forEach(function(e){e.setX(e.getX()+t.x),e.setY(e.getY()+t.y)}),this.render()},activate:function(){return this.__base(),this.vertexes.forEach(function(t){t.activate()}),this.bringToFront(),this},deactivate:function(){return this.__base(),this.vertexes.forEach(function(t){t.deactivate()}),this},isSimple:function(e){for(var i=t.CartesianGeometryMath.generateLineSegments(this.getValue(!1)),n=i.length,s=0;s<n-2;s++)for(var o=s+2;o<n-(s>0?0:1);o++)if(t.CartesianGeometryMath.checkLinesIntersection(i[s],i[o]))return e&&this.select(),!1;return!0},getValue:function(t){var e=this.getContainerRect();return this.vertexes.reduce(function(i,n){return t?i.push(n.getX()/e.width,n.getY()/e.height):i.push(n.getX(),n.getY()),i},[])},resize:function(t,e){this.vertexes.forEach(function(i){i.setX(i.getX()*t),i.setY(i.getY()*e)}),this.render()},select:function(){return this.container.setActiveElement(this),this},_removeVertex:function(t){this.vertexes.length<4||(this.vertexes.splice(this.vertexes.indexOf(t),1),this.remove(t).render())},_createVertex:function(e){var i=new t.SVGPolygonVertex({width:t["default"].control.width,height:t["default"].control.height,x:e[0],y:e[1],cssClass:"svg-polygon-vertex"}),n=function(t){this._removeVertex(i),t.stopPropagation()}.bind(this);return this.append(i),t._isTouchDevice?i.onDoubleTap(n):i.on("dblclick",n),i},_onContainerDblClick:function(e){if(this.isActive){var i=this.getContainerRect(),n=t._isTouchDevice?[e.changedTouches[0].clientX-i.left,e.changedTouches[0].clientY-i.top]:[e.offsetX,e.offsetY];this.addPoint(n)}}})}(svgext),function(t){"use strict";t.SVGRectControls=inherit(t.SVGRect,{__constructor:function(e){if(!e.type)throw new Error("Type should be set in a SVGRectControls constructor");this.__base(e),this.type=e.type,this.addClass("svg-rectangle-control_type_"+this.type),t._isTouchDevice&&this.addClass("svg-control_type_touch")},normalizeCoords:function(t){var e=this.width(),i=this.height(),n=this.getX()+e/2,s=this.getY()+i/2,o=this.getContainerRect();return n+t.x<0?t.x=-1*n:n+t.x>o.width&&(t.x=o.width-n),s+t.y<0?t.y=-1*s:s+t.y>o.height&&(t.y=o.height-s),t},drag:function(t){t["horizontal"===this.type?"y":"x"]=0,this.__base(t),this.container.update(this.type)}})}(svgext),function(t){"use strict";var e=[t.SVGRect,t.SVGBlock];t.SVGResizableRect=inherit(e,{__constructor:function(e){if(!(e.width&&e.height&&e.x&&e.y))throw new Error("Missing property. Properties:width, height, x and y are required by SVGResizableRectangle.");e.cssClass=e.cssClass||"svg-resizable-rectangle",this.__base(e),this.rootNode=this.createElem("g"),this.appendElem(this.node),this._createControls(),this.on(t._isTouchDevice?"touchstart":"mousedown",this.select.bind(this))},update:function(e){var i,n=this.controls;if("vertical"===e){i=n[0].getY()>=n[1].getY()?1:0,this.setY(t["default"].control.height/2+n[i].getY()),this.height(n[i?0:1].getY()-n[i].getY());var s=this.getY()+this.height()/2-t["default"].control.height/2;[n[2],n[3]].forEach(function(t){t.setY(s)})}else{i=n[2].getX()>=n[3].getX()?3:2,this.setX(t["default"].control.width/2+n[i].getX()),this.width(n[3===i?2:3].getX()-n[i].getX());var o=this.getX()+this.width()/2-t["default"].control.width/2;[n[0],n[1]].forEach(function(t){t.setX(o)})}},activate:function(){return this.__base(),this.controls.forEach(function(t){t.activate()}),this.bringToFront(),this},deactivate:function(){return this.__base(),this.controls.forEach(function(t){t.deactivate()}),this},drag:function(t){this.controls.concat(this).forEach(function(e){e.setX(e.getX()+t.x).setY(e.getY()+t.y)})},select:function(){return this.container.setActiveElement(this),this},resize:function(t,e){this.setX(this.getX()*t),this.setY(this.getY()*e),this.width(this.width()*t),this.height(this.height()*e),this.controls.forEach(function(i){i.setX(i.getX()*t).setY(i.getY()*e)},this)},_addControl:function(e){var i=new t.SVGRectControls(e);this.append(i),this.controls.push(i)},_createControls:function(){if(!this.controlCreated){this.controls=[];var e=t["default"].control.width/2,i=t["default"].control.height/2,n={width:t["default"].control.width,height:t["default"].control.height,cssClass:"svg-rectangle-control"};return n.type="vertical",n.x=this.getX()+this.width()/2-e,n.y=this.getY()-i,this._addControl(n),n.y=this.getY()+this.height()-i,this._addControl(n),n.type="horizontal",n.x=this.getX()+this.width()-e,n.y=this.getY()+this.height()/2-i,this._addControl(n),n.x=this.getX()-e,this._addControl(n),this.controlCreated=!0,this}}})}(svgext),function(t){"use strict";t.SVGBorder=inherit(t.SVGElement,{__constructor:function(){this.__base({isDraggable:!1,cssClass:"svg-border",backgroundColor:"none"},"rect")},onAppend:function(t){this.__base(t),this.render()},render:function(e){var i=t["default"].borderedRect.borderOffset;"x"!==e&&this.attr("y",this.container.getY()-i).attr("height",this.container.height()+2*i),"y"!==e&&this.attr("x",this.container.getX()-i).attr("width",this.container.width()+2*i)}})}(svgext),function(t){"use strict";t.SVGBorderControl=inherit(t.SVGRect,{__constructor:function(){this.__base({cssClass:"svg-border-control",isDraggable:!0,width:t["default"].control.width,height:t["default"].control.width}),t._isTouchDevice&&this.addClass("svg-control_type_touch")},onAppend:function(t){this.__base(t),this.render()},normalizeCoords:function(t){var e=this.getContainerRect(),i=this.container;return i.width()+t.x<1?t.x=i.width()>1?-1*(i.width()-1):0:i.getX()+i.width()+t.x>e.width&&(t.x=e.width-i.getX()-i.width()),i.height()+t.y<1?t.y=i.height()>1?-1*i.height()+1:0:i.getY()+i.height()+t.y>e.height&&(t.y=e.height-i.getY()-i.height()),t},drag:function(t){var e=this.container;e.width(e.width()+t.x).height(e.height()+t.y)},render:function(e){var i=this.container,n=t["default"].borderedRect.borderOffset;"x"!==e&&this.setY(i.getY()+i.height()+n-t["default"].control.height/2),"y"!==e&&this.setX(i.getX()+i.width()+n-t["default"].control.width/2)}})}(svgext),function(t){"use strict";t.SVGBorderedRect=inherit([t.SVGRect,t.SVGBlock],{__constructor:function(e){if(!(e.width&&e.height&&e.x&&e.y))throw new Error("Missing property. Properties:width, height, x and y are required by SVGResizeableRectangle.");e.cssClass=e.cssClass||"svg-bordered-rect",this.__base(e),this.rootNode=this.createElem("g"),this.appendElem(this.node),this.border=new t.SVGBorder,this.append(this.border),this.control=new t.SVGBorderControl,this.append(this.control),this.on(t._isTouchDevice?"touchstart":"mousedown",this.select.bind(this))},width:function(t){var e=this.__base(t);return t&&this.renderComponents("x"),e},height:function(t){var e=this.__base(t);return t&&this.renderComponents("y"),e},activate:function(){return this.__base(),this.border.activate(),this.control.activate(),this.bringToFront(),this},deactivate:function(){return this.__base(),this.border.deactivate(),this.control.deactivate(),this},drag:function(t){this.setX(this.getX()+t.x).setY(this.getY()+t.y),this.renderComponents()},select:function(){return this.container.setActiveElement(this),this},resize:function(t,e){this.setX(this.getX()*t),this.setY(this.getY()*e),this.width(this.width()*t),this.height(this.height()*e),this.renderComponents()},renderComponents:function(t){this.border&&this.control&&(this.border.render(t),this.control.render(t))}})}(svgext);